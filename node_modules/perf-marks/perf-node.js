const { PerformanceObserver, performance } = require('perf_hooks');
const { spawnSync } = require('child_process');

const markName = 'testing';
let performanceResult;

const sleep = timeInMilliseconds => new Promise(resolve => setTimeout(resolve, timeInMilliseconds));

const start = async () => {
  const obs = new PerformanceObserver(list => {
    performanceResult = list.getEntries().find(f => f.name === markName);
    obs.disconnect();
  });
  obs.observe({ entryTypes: ['measure'] });

  performance.mark(`${markName}-init`);

  await sleep(1000);

  performance.mark(`${markName}-end`);
  performance.measure(markName, `${markName}-init`, `${markName}-end`);
  console.log('>>>>>>>>>.');
  console.log(performanceResult);
  console.log('>>>>>>>>>.');
};

start();
